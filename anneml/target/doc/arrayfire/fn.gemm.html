<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="BLAS general matrix multiply (GEMM) of two Array objects"><meta name="keywords" content="rust, rustlang, rust-lang, gemm"><title>gemm in arrayfire - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="http:&#x2F;&#x2F;www.rust-lang.org&#x2F;favicon.ico"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a class="sidebar-logo" href="../arrayfire/index.html"><div class="logo-container"><img src="http:&#x2F;&#x2F;www.arrayfire.com&#x2F;logos&#x2F;arrayfire_logo_symbol.png" alt="logo"></div>
        </a><div class="sidebar-elems"><h2 class="location">Other items in<br><a href="index.html">arrayfire</a></h2><div id="sidebar-vars" data-name="gemm" data-ty="fn" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../arrayfire/index.html"><img src="http:&#x2F;&#x2F;www.arrayfire.com&#x2F;logos&#x2F;arrayfire_logo_symbol.png" alt="logo"></a><nav class="sub"><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><h1 class="fqn"><span class="in-band">Function <a href="index.html">arrayfire</a>::<wbr><a class="fn" href="#">gemm</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/arrayfire/blas/mod.rs.html#122-147" title="goto source code">[src]</a></span></h1><div class="docblock item-decl"><pre class="rust fn"><code>pub fn gemm&lt;T&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;output: &amp;mut <a class="struct" href="struct.Array.html" title="struct arrayfire::Array">Array</a>&lt;T&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;optlhs: <a class="enum" href="enum.MatProp.html" title="enum arrayfire::MatProp">MatProp</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;optrhs: <a class="enum" href="enum.MatProp.html" title="enum arrayfire::MatProp">MatProp</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;alpha: <a class="struct" href="https://doc.rust-lang.org/1.59.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;T&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;lhs: &amp;<a class="struct" href="struct.Array.html" title="struct arrayfire::Array">Array</a>&lt;T&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;rhs: &amp;<a class="struct" href="struct.Array.html" title="struct arrayfire::Array">Array</a>&lt;T&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;beta: <a class="struct" href="https://doc.rust-lang.org/1.59.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;T&gt;<br>) <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="trait.HasAfEnum.html" title="trait arrayfire::HasAfEnum">HasAfEnum</a> + <a class="trait" href="trait.FloatingPoint.html" title="trait arrayfire::FloatingPoint">FloatingPoint</a>,&nbsp;</span></code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>BLAS general matrix multiply (GEMM) of two Array objects</p>
<p>This provides a general interface to the BLAS level 3 general matrix multiply (GEMM),
which is generally defined as:</p>
<p>\begin{equation}
C = \alpha * opA(A)opB(B) + \beta * C
\end{equation}</p>
<p>where $\alpha$ (<strong>alpha</strong>) and $\beta$ (<strong>beta</strong>) are both scalars; $A$ and $B$ are the matrix
multiply operands; and $opA$ and $opB$ are noop
(if optLhs is <a href="./enum.MatProp.html">MatProp::NONE</a>) or transpose
(if optLhs is <a href="./enum.MatProp.html">MatProp::TRANS</a>) operations on $A$ or $B$ before the
actual GEMM operation. Batched GEMM is supported if at least either $A$ or $B$ have more than
two dimensions (see <a href="http://arrayfire.org/docs/group__blas__func__matmul.htm#ga63306b6ed967bd1055086db862fe885b">af::matmul</a>
for more details on broadcasting). However, only one <strong>alpha</strong> and one <strong>beta</strong> can be used
for all of the batched matrix operands.</p>
<p>The <code>output</code> Array can be used both as an input and output. An allocation will be performed
if you pass an empty Array (i.e. <code>let c: Array&lt;f32&gt; = (0 as i64).into();</code>). If a valid Array
is passed as $C$, the operation will be performed on that Array itself. The C Array must be
the correct type and shape; otherwise, an error will be thrown.</p>
<p>Note: Passing an Array that has not been initialized to the C array
will cause undefined behavior.</p>
<h2 id="examples" class="section-header"><a href="#examples">Examples</a></h2>
<p>Given below is an example of using gemm API with existing Arrays</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">arrayfire</span>::{<span class="ident">Array</span>, <span class="ident">Dim4</span>, <span class="ident">print</span>, <span class="ident">randu</span>, <span class="ident">gemm</span>};

<span class="kw">let</span> <span class="ident">dims</span> <span class="op">=</span> <span class="ident">Dim4::new</span>(<span class="kw-2">&amp;</span>[<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>]);

<span class="kw">let</span> <span class="ident">alpha</span> <span class="op">=</span> <span class="macro">vec!</span>[<span class="number">1.0</span> <span class="kw">as</span> <span class="ident">f32</span>];
<span class="kw">let</span>  <span class="ident">beta</span> <span class="op">=</span> <span class="macro">vec!</span>[<span class="number">2.0</span> <span class="kw">as</span> <span class="ident">f32</span>];

<span class="kw">let</span> <span class="ident">lhs</span> <span class="op">=</span> <span class="ident">randu</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span>(<span class="ident">dims</span>);
<span class="kw">let</span> <span class="ident">rhs</span> <span class="op">=</span> <span class="ident">randu</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span>(<span class="ident">dims</span>);

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">result</span> <span class="op">=</span> <span class="ident">Array::new_empty</span>(<span class="ident">dims</span>);
<span class="ident">gemm</span>(<span class="kw-2">&amp;mut</span> <span class="ident">result</span>, <span class="ident">arrayfire::MatProp::NONE</span>, <span class="ident">arrayfire::MatProp::NONE</span>,
     <span class="ident">alpha</span>, <span class="kw-2">&amp;</span><span class="ident">lhs</span>, <span class="kw-2">&amp;</span><span class="ident">rhs</span>, <span class="ident">beta</span>);</code></pre></div>
<p>If you don’t have an existing Array, you can also use gemm in the following fashion.
However, if there is no existing Array that you need to fill and your use case doesn’t
deal with alpha and beta from gemm equation, it is recommended to use
<a href="./fn.matmul.html">matmul</a> for more terse code.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">arrayfire</span>::{<span class="ident">Array</span>, <span class="ident">Dim4</span>, <span class="ident">af_array</span>, <span class="ident">print</span>, <span class="ident">randu</span>, <span class="ident">gemm</span>};

<span class="kw">let</span> <span class="ident">dims</span> <span class="op">=</span> <span class="ident">Dim4::new</span>(<span class="kw-2">&amp;</span>[<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>]);

<span class="kw">let</span> <span class="ident">alpha</span> <span class="op">=</span> <span class="macro">vec!</span>[<span class="number">1.0</span> <span class="kw">as</span> <span class="ident">f32</span>];
<span class="kw">let</span>  <span class="ident">beta</span> <span class="op">=</span> <span class="macro">vec!</span>[<span class="number">2.0</span> <span class="kw">as</span> <span class="ident">f32</span>];

<span class="kw">let</span> <span class="ident">lhs</span> <span class="op">=</span> <span class="ident">randu</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span>(<span class="ident">dims</span>);
<span class="kw">let</span> <span class="ident">rhs</span> <span class="op">=</span> <span class="ident">randu</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span>(<span class="ident">dims</span>);

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">result</span>: <span class="ident">Array</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span> <span class="op">=</span> (<span class="ident">std::ptr::null_mut</span>() <span class="kw">as</span> <span class="ident">af_array</span>).<span class="ident">into</span>();

<span class="ident">gemm</span>(<span class="kw-2">&amp;mut</span> <span class="ident">result</span>, <span class="ident">arrayfire::MatProp::NONE</span>, <span class="ident">arrayfire::MatProp::NONE</span>,
     <span class="ident">alpha</span>, <span class="kw-2">&amp;</span><span class="ident">lhs</span>, <span class="kw-2">&amp;</span><span class="ident">rhs</span>, <span class="ident">beta</span>);</code></pre></div>
<h2 id="parameters" class="section-header"><a href="#parameters">Parameters</a></h2>
<ul>
<li><code>optlhs</code> - Transpose left hand side before the function is performed, uses one of the values of <a href="./enum.MatProp.html">MatProp</a></li>
<li><code>optrhs</code> - Transpose right hand side before the function is performed, uses one of the values of <a href="./enum.MatProp.html">MatProp</a></li>
<li><code>alpha</code> is alpha value;</li>
<li><code>lhs</code> is the Array on left hand side</li>
<li><code>rhs</code> is the Array on right hand side</li>
<li><code>beta</code> is beta value;</li>
</ul>
<h2 id="return-values" class="section-header"><a href="#return-values">Return Values</a></h2>
<p>Array, result of gemm operation</p>
</div></details></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="arrayfire" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.59.0 (9d1b2106e 2022-02-23)" ></div>
</body></html>